package com.complexica.itinerary.modules.system.service.impl;

import cn.hutool.core.date.DateUtil;
import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;
import com.complexica.itinerary.modules.system.model.Weather;
import com.complexica.itinerary.modules.system.service.WeatherService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.web.client.RestTemplate;


import java.util.ArrayList;
import java.util.List;
/**
 * Weather Service Implement class for weather forecast access
 * @author Li He
 * @date 2021-02-10
 */
@Service("weatherService")
public class WeatherServiceImpl implements WeatherService {

    @Override
    public List<Weather> getWeather(String cityName, String queryDate) {

        return null;
    }

    @Autowired
    private RestTemplate restTemplate;


    /**
     * Get weather forecast from api
     * @param cityName
     * @param country
     * @return
     */
    @Override
    public List<Weather> getApiWeather(String cityName, String country){
        //Using restTemplate to request weather from weather api
        String forObject = restTemplate.getForObject("http://api.openweathermap.org/data/2.5/forecast?q=" + cityName+","+country+"&appid=d9e61ace13b73a7ea74fcb3b44c444e0", String.class);
//        String forObject = "{\"cod\":\"200\",\"message\":0,\"cnt\":40,\"list\":[{\"dt\":1612839600,\"main\":{\"temp\":301.08,\"feels_like\":299.62,\"temp_min\":300.84,\"temp_max\":301.08,\"pressure\":1012,\"sea_level\":1012,\"grnd_level\":1007,\"humidity\":28,\"temp_kf\":0.24},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":7},\"wind\":{\"speed\":1.33,\"deg\":241},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-09 03:00:00\"},{\"dt\":1612850400,\"main\":{\"temp\":301.26,\"feels_like\":298.36,\"temp_min\":301.25,\"temp_max\":301.26,\"pressure\":1011,\"sea_level\":1011,\"grnd_level\":1005,\"humidity\":28,\"temp_kf\":0.01},\"weather\":[{\"id\":802,\"main\":\"Clouds\",\"description\":\"scattered clouds\",\"icon\":\"03d\"}],\"clouds\":{\"all\":25},\"wind\":{\"speed\":3.44,\"deg\":218},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-09 06:00:00\"},{\"dt\":1612861200,\"main\":{\"temp\":298.84,\"feels_like\":296.45,\"temp_min\":298.67,\"temp_max\":298.84,\"pressure\":1011,\"sea_level\":1011,\"grnd_level\":1005,\"humidity\":37,\"temp_kf\":0.17},\"weather\":[{\"id\":802,\"main\":\"Clouds\",\"description\":\"scattered clouds\",\"icon\":\"03d\"}],\"clouds\":{\"all\":35},\"wind\":{\"speed\":3.44,\"deg\":171},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-09 09:00:00\"},{\"dt\":1612872000,\"main\":{\"temp\":295.44,\"feels_like\":292.98,\"temp_min\":295.39,\"temp_max\":295.44,\"pressure\":1012,\"sea_level\":1012,\"grnd_level\":1006,\"humidity\":44,\"temp_kf\":0.05},\"weather\":[{\"id\":802,\"main\":\"Clouds\",\"description\":\"scattered clouds\",\"icon\":\"03n\"}],\"clouds\":{\"all\":30},\"wind\":{\"speed\":3.36,\"deg\":115},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2021-02-09 12:00:00\"},{\"dt\":1612882800,\"main\":{\"temp\":294.44,\"feels_like\":292.49,\"temp_min\":294.44,\"temp_max\":294.44,\"pressure\":1011,\"sea_level\":1011,\"grnd_level\":1005,\"humidity\":46,\"temp_kf\":0},\"weather\":[{\"id\":802,\"main\":\"Clouds\",\"description\":\"scattered clouds\",\"icon\":\"03n\"}],\"clouds\":{\"all\":28},\"wind\":{\"speed\":2.55,\"deg\":101},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2021-02-09 15:00:00\"},{\"dt\":1612893600,\"main\":{\"temp\":293.81,\"feels_like\":292.44,\"temp_min\":293.81,\"temp_max\":293.81,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":1004,\"humidity\":47,\"temp_kf\":0},\"weather\":[{\"id\":801,\"main\":\"Clouds\",\"description\":\"few clouds\",\"icon\":\"02n\"}],\"clouds\":{\"all\":16},\"wind\":{\"speed\":1.63,\"deg\":106},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2021-02-09 18:00:00\"},{\"dt\":1612904400,\"main\":{\"temp\":294.44,\"feels_like\":293.05,\"temp_min\":294.44,\"temp_max\":294.44,\"pressure\":1011,\"sea_level\":1011,\"grnd_level\":1005,\"humidity\":43,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":2},\"wind\":{\"speed\":1.39,\"deg\":92},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-09 21:00:00\"},{\"dt\":1612915200,\"main\":{\"temp\":301.38,\"feels_like\":299.96,\"temp_min\":301.38,\"temp_max\":301.38,\"pressure\":1011,\"sea_level\":1011,\"grnd_level\":1005,\"humidity\":28,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":1},\"wind\":{\"speed\":1.35,\"deg\":33},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-10 00:00:00\"},{\"dt\":1612926000,\"main\":{\"temp\":305.09,\"feels_like\":303,\"temp_min\":305.09,\"temp_max\":305.09,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":1004,\"humidity\":21,\"temp_kf\":0},\"weather\":[{\"id\":801,\"main\":\"Clouds\",\"description\":\"few clouds\",\"icon\":\"02d\"}],\"clouds\":{\"all\":16},\"wind\":{\"speed\":1.94,\"deg\":236},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-10 03:00:00\"},{\"dt\":1612936800,\"main\":{\"temp\":303.75,\"feels_like\":300.21,\"temp_min\":303.75,\"temp_max\":303.75,\"pressure\":1008,\"sea_level\":1008,\"grnd_level\":1002,\"humidity\":24,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":10},\"wind\":{\"speed\":4.3,\"deg\":210},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-10 06:00:00\"},{\"dt\":1612947600,\"main\":{\"temp\":302.15,\"feels_like\":298.97,\"temp_min\":302.15,\"temp_max\":302.15,\"pressure\":1008,\"sea_level\":1008,\"grnd_level\":1002,\"humidity\":28,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":4.1,\"deg\":174},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-10 09:00:00\"},{\"dt\":1612958400,\"main\":{\"temp\":298.51,\"feels_like\":295.51,\"temp_min\":298.51,\"temp_max\":298.51,\"pressure\":1008,\"sea_level\":1008,\"grnd_level\":1002,\"humidity\":32,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":3.44,\"deg\":116},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2021-02-10 12:00:00\"},{\"dt\":1612969200,\"main\":{\"temp\":297.62,\"feels_like\":295.3,\"temp_min\":297.62,\"temp_max\":297.62,\"pressure\":1007,\"sea_level\":1007,\"grnd_level\":1001,\"humidity\":36,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":2.8,\"deg\":90},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2021-02-10 15:00:00\"},{\"dt\":1612980000,\"main\":{\"temp\":297.73,\"feels_like\":295.62,\"temp_min\":297.73,\"temp_max\":297.73,\"pressure\":1005,\"sea_level\":1005,\"grnd_level\":999,\"humidity\":36,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":2.53,\"deg\":67},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2021-02-10 18:00:00\"},{\"dt\":1612990800,\"main\":{\"temp\":299.75,\"feels_like\":295.87,\"temp_min\":299.75,\"temp_max\":299.75,\"pressure\":1004,\"sea_level\":1004,\"grnd_level\":998,\"humidity\":31,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":4.9,\"deg\":34},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-10 21:00:00\"},{\"dt\":1613001600,\"main\":{\"temp\":304.41,\"feels_like\":301.07,\"temp_min\":304.41,\"temp_max\":304.41,\"pressure\":1004,\"sea_level\":1004,\"grnd_level\":998,\"humidity\":30,\"temp_kf\":0},\"weather\":[{\"id\":802,\"main\":\"Clouds\",\"description\":\"scattered clouds\",\"icon\":\"03d\"}],\"clouds\":{\"all\":50},\"wind\":{\"speed\":5.49,\"deg\":360},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-11 00:00:00\"},{\"dt\":1613012400,\"main\":{\"temp\":306.06,\"feels_like\":301.42,\"temp_min\":306.06,\"temp_max\":306.06,\"pressure\":1003,\"sea_level\":1003,\"grnd_level\":997,\"humidity\":27,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":99},\"wind\":{\"speed\":7.26,\"deg\":312},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-11 03:00:00\"},{\"dt\":1613023200,\"main\":{\"temp\":300.36,\"feels_like\":297.44,\"temp_min\":300.36,\"temp_max\":300.36,\"pressure\":1002,\"sea_level\":1002,\"grnd_level\":996,\"humidity\":40,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":96},\"wind\":{\"speed\":5.24,\"deg\":227},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-11 06:00:00\"},{\"dt\":1613034000,\"main\":{\"temp\":296.79,\"feels_like\":293.14,\"temp_min\":296.79,\"temp_max\":296.79,\"pressure\":1006,\"sea_level\":1006,\"grnd_level\":1000,\"humidity\":53,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":100},\"wind\":{\"speed\":6.78,\"deg\":240},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-11 09:00:00\"},{\"dt\":1613044800,\"main\":{\"temp\":293.07,\"feels_like\":291.77,\"temp_min\":293.07,\"temp_max\":293.07,\"pressure\":1009,\"sea_level\":1009,\"grnd_level\":1003,\"humidity\":78,\"temp_kf\":0},\"weather\":[{\"id\":500,\"main\":\"Rain\",\"description\":\"light rain\",\"icon\":\"10n\"}],\"clouds\":{\"all\":100},\"wind\":{\"speed\":4.67,\"deg\":239},\"visibility\":10000,\"pop\":0.32,\"rain\":{\"3h\":0.27},\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2021-02-11 12:00:00\"},{\"dt\":1613055600,\"main\":{\"temp\":292.75,\"feels_like\":292.93,\"temp_min\":292.75,\"temp_max\":292.75,\"pressure\":1007,\"sea_level\":1007,\"grnd_level\":1001,\"humidity\":81,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04n\"}],\"clouds\":{\"all\":100},\"wind\":{\"speed\":2.71,\"deg\":247},\"visibility\":10000,\"pop\":0.04,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2021-02-11 15:00:00\"},{\"dt\":1613066400,\"main\":{\"temp\":291.74,\"feels_like\":289.96,\"temp_min\":291.74,\"temp_max\":291.74,\"pressure\":1007,\"sea_level\":1007,\"grnd_level\":1001,\"humidity\":75,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04n\"}],\"clouds\":{\"all\":100},\"wind\":{\"speed\":4.39,\"deg\":216},\"visibility\":10000,\"pop\":0.02,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2021-02-11 18:00:00\"},{\"dt\":1613077200,\"main\":{\"temp\":291.04,\"feels_like\":288.87,\"temp_min\":291.04,\"temp_max\":291.04,\"pressure\":1008,\"sea_level\":1008,\"grnd_level\":1002,\"humidity\":70,\"temp_kf\":0},\"weather\":[{\"id\":804,\"main\":\"Clouds\",\"description\":\"overcast clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":94},\"wind\":{\"speed\":4.13,\"deg\":207},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-11 21:00:00\"},{\"dt\":1613088000,\"main\":{\"temp\":292.92,\"feels_like\":290.24,\"temp_min\":292.92,\"temp_max\":292.92,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":1004,\"humidity\":57,\"temp_kf\":0},\"weather\":[{\"id\":803,\"main\":\"Clouds\",\"description\":\"broken clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":64},\"wind\":{\"speed\":4.3,\"deg\":223},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-12 00:00:00\"},{\"dt\":1613098800,\"main\":{\"temp\":293.69,\"feels_like\":290.23,\"temp_min\":293.69,\"temp_max\":293.69,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":1004,\"humidity\":54,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":1},\"wind\":{\"speed\":5.37,\"deg\":241},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-12 03:00:00\"},{\"dt\":1613109600,\"main\":{\"temp\":293.54,\"feels_like\":289.89,\"temp_min\":293.54,\"temp_max\":293.54,\"pressure\":1009,\"sea_level\":1009,\"grnd_level\":1003,\"humidity\":55,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":1},\"wind\":{\"speed\":5.69,\"deg\":228},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-12 06:00:00\"},{\"dt\":1613120400,\"main\":{\"temp\":292.03,\"feels_like\":287.99,\"temp_min\":292.03,\"temp_max\":292.03,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":1004,\"humidity\":62,\"temp_kf\":0},\"weather\":[{\"id\":802,\"main\":\"Clouds\",\"description\":\"scattered clouds\",\"icon\":\"03d\"}],\"clouds\":{\"all\":29},\"wind\":{\"speed\":6.41,\"deg\":216},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-12 09:00:00\"},{\"dt\":1613131200,\"main\":{\"temp\":289.4,\"feels_like\":286.54,\"temp_min\":289.4,\"temp_max\":289.4,\"pressure\":1013,\"sea_level\":1013,\"grnd_level\":1007,\"humidity\":69,\"temp_kf\":0},\"weather\":[{\"id\":801,\"main\":\"Clouds\",\"description\":\"few clouds\",\"icon\":\"02n\"}],\"clouds\":{\"all\":19},\"wind\":{\"speed\":4.37,\"deg\":179},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2021-02-12 12:00:00\"},{\"dt\":1613142000,\"main\":{\"temp\":288.46,\"feels_like\":285.88,\"temp_min\":288.46,\"temp_max\":288.46,\"pressure\":1013,\"sea_level\":1013,\"grnd_level\":1007,\"humidity\":73,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":2},\"wind\":{\"speed\":3.94,\"deg\":184},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2021-02-12 15:00:00\"},{\"dt\":1613152800,\"main\":{\"temp\":287.85,\"feels_like\":285.57,\"temp_min\":287.85,\"temp_max\":287.85,\"pressure\":1013,\"sea_level\":1013,\"grnd_level\":1007,\"humidity\":77,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":9},\"wind\":{\"speed\":3.6,\"deg\":181},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2021-02-12 18:00:00\"},{\"dt\":1613163600,\"main\":{\"temp\":288.72,\"feels_like\":286.8,\"temp_min\":288.72,\"temp_max\":288.72,\"pressure\":1014,\"sea_level\":1014,\"grnd_level\":1008,\"humidity\":73,\"temp_kf\":0},\"weather\":[{\"id\":802,\"main\":\"Clouds\",\"description\":\"scattered clouds\",\"icon\":\"03d\"}],\"clouds\":{\"all\":34},\"wind\":{\"speed\":3.11,\"deg\":171},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-12 21:00:00\"},{\"dt\":1613174400,\"main\":{\"temp\":292.17,\"feels_like\":290.37,\"temp_min\":292.17,\"temp_max\":292.17,\"pressure\":1016,\"sea_level\":1016,\"grnd_level\":1010,\"humidity\":57,\"temp_kf\":0},\"weather\":[{\"id\":803,\"main\":\"Clouds\",\"description\":\"broken clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":52},\"wind\":{\"speed\":2.75,\"deg\":200},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-13 00:00:00\"},{\"dt\":1613185200,\"main\":{\"temp\":294.57,\"feels_like\":291.52,\"temp_min\":294.57,\"temp_max\":294.57,\"pressure\":1015,\"sea_level\":1015,\"grnd_level\":1009,\"humidity\":50,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":8},\"wind\":{\"speed\":4.64,\"deg\":232},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-13 03:00:00\"},{\"dt\":1613196000,\"main\":{\"temp\":295.02,\"feels_like\":292.04,\"temp_min\":295.02,\"temp_max\":295.02,\"pressure\":1014,\"sea_level\":1014,\"grnd_level\":1008,\"humidity\":55,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":4},\"wind\":{\"speed\":5.33,\"deg\":212},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-13 06:00:00\"},{\"dt\":1613206800,\"main\":{\"temp\":292.86,\"feels_like\":289.17,\"temp_min\":292.86,\"temp_max\":292.86,\"pressure\":1015,\"sea_level\":1015,\"grnd_level\":1009,\"humidity\":56,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":1},\"wind\":{\"speed\":5.61,\"deg\":162},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-13 09:00:00\"},{\"dt\":1613217600,\"main\":{\"temp\":288.85,\"feels_like\":286.32,\"temp_min\":288.85,\"temp_max\":288.85,\"pressure\":1016,\"sea_level\":1016,\"grnd_level\":1010,\"humidity\":70,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":1},\"wind\":{\"speed\":3.78,\"deg\":135},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2021-02-13 12:00:00\"},{\"dt\":1613228400,\"main\":{\"temp\":287.59,\"feels_like\":285.75,\"temp_min\":287.59,\"temp_max\":287.59,\"pressure\":1016,\"sea_level\":1016,\"grnd_level\":1010,\"humidity\":76,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":2.8,\"deg\":123},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2021-02-13 15:00:00\"},{\"dt\":1613239200,\"main\":{\"temp\":287.05,\"feels_like\":285.53,\"temp_min\":287.05,\"temp_max\":287.05,\"pressure\":1016,\"sea_level\":1016,\"grnd_level\":1009,\"humidity\":78,\"temp_kf\":0},\"weather\":[{\"id\":801,\"main\":\"Clouds\",\"description\":\"few clouds\",\"icon\":\"02n\"}],\"clouds\":{\"all\":16},\"wind\":{\"speed\":2.29,\"deg\":127},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2021-02-13 18:00:00\"},{\"dt\":1613250000,\"main\":{\"temp\":287.25,\"feels_like\":285.88,\"temp_min\":287.25,\"temp_max\":287.25,\"pressure\":1016,\"sea_level\":1016,\"grnd_level\":1010,\"humidity\":78,\"temp_kf\":0},\"weather\":[{\"id\":803,\"main\":\"Clouds\",\"description\":\"broken clouds\",\"icon\":\"04d\"}],\"clouds\":{\"all\":59},\"wind\":{\"speed\":2.15,\"deg\":115},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-13 21:00:00\"},{\"dt\":1613260800,\"main\":{\"temp\":293.88,\"feels_like\":292.55,\"temp_min\":293.88,\"temp_max\":293.88,\"pressure\":1017,\"sea_level\":1017,\"grnd_level\":1011,\"humidity\":50,\"temp_kf\":0},\"weather\":[{\"id\":802,\"main\":\"Clouds\",\"description\":\"scattered clouds\",\"icon\":\"03d\"}],\"clouds\":{\"all\":29},\"wind\":{\"speed\":1.94,\"deg\":188},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2021-02-14 00:00:00\"}],\"city\":{\"id\":2078025,\"name\":\"Adelaide\",\"coord\":{\"lat\":-34.9333,\"lon\":138.6},\"country\":\"AU\",\"population\":1074159,\"timezone\":37800,\"sunrise\":1612815196,\"sunset\":1612863987}}";
        System.out.println("getApiWeather");
        //parsing json file to object
        JSONObject jsonObject = JSON.parseObject(forObject);
        String cityId = jsonObject.getJSONObject("city").getString("id");
        JSONArray weathers = jsonObject.getJSONArray("list");
        List<Weather> result = new ArrayList<Weather>();
        int i=0;
        //arse the different time weather of the city
        for (Object wether: weathers) {
            ++i;
            JSONObject jobj = (JSONObject) wether;
            Integer id =  jobj.getInteger("dt");
            String temp  = jobj.getJSONObject("main").getString("temp");
            String weather  = jobj.getJSONArray("weather").getJSONObject(0).getString("description");
            String time  = jobj.getString("dt_txt");
            String[] date_time = time.split(" ");
            String weatherTime = date_time[1].substring(0,2);

            Weather Weather = new Weather(id,cityId,cityName,country,date_time[0],weatherTime,temp,weather,"1",i+"");
            result.add(Weather);
        }
        return result;
}
}
